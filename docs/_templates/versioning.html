<!--
format of versions.json

{
    "current": "v1.2.3",
    "versions": [
        {
            "version": "v1.2.3",
            "url": "",
            "title": "v1.2.3 (stable)"
        },
        {
            "version": "dev",
            "url": "/versions/dev/",
            "title": "dev (development)"
        }
    ]
}


-->
<select id="version-selector" onchange="switchVersion(this.value)">
    <option value="">Loading versions...</option>
</select>

<style>
    .version-sidebar {
        padding: 10px;
        margin: 10px 0;
        border: 1px solid #e1e4e5;
        border-radius: 4px;
    }

    #version-selector {
        width: 100%;
        padding: 5px;
        border-radius: 3px;
        border: 1px solid #ccc;
    }
</style>

<script>
    async function loadVersions() {
        try {
            const response = await fetch('/_static/versions.json');
            const data = await response.json();
            const selector = document.getElementById('version-selector');
            selector.innerHTML = '';

            data.versions.forEach(version => {
                const option = document.createElement('option');
                option.value = version.url;
                option.text = version.title;
                if (window.location.pathname.includes(`/versions/${version.version}/`)) {
                    option.selected = true;
                } else if (version.url === '' && !window.location.pathname.includes('/versions/')) {
                    option.selected = true;
                }
                selector.appendChild(option);
            });
        } catch (error) {
            console.error('Error loading versions:', error);
        }
    }

    function switchVersion(url) {
        if (url) {
            window.location.href = url;
        } else {
            window.location.href = '/';
        }
    }

    document.addEventListener('DOMContentLoaded', loadVersions);
</script>
